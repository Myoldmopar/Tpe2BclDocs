<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: TpeBclCore::Products::PVModule
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!TpeBclCore/Products/PVModule.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../TpeBclCore.html" title="TpeBclCore (module)">TpeBclCore</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Products.html" title="TpeBclCore::Products (module)">Products</a></span></span>
     &raquo; 
    <span class="title">PVModule</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: TpeBclCore::Products::PVModule
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="ProductBaseClass.html" title="TpeBclCore::Products::ProductBaseClass (class)">ProductBaseClass</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="ProductBaseClass.html" title="TpeBclCore::Products::ProductBaseClass (class)">ProductBaseClass</a></span></li>
          
            <li class="next">TpeBclCore::Products::PVModule</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/products/PVModules.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>A simple module containing routines for writing PV Module components</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="PVModule/Map.html" title="TpeBclCore::Products::PVModule::Map (class)">Map</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="PARAM_MODULEEFFICIENCY-constant" class="">PARAM_MODULEEFFICIENCY =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for module efficiency</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Module Efficiency</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="PARAM_RATEDPOWER-constant" class="">PARAM_RATEDPOWER =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for rated power</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Rated Power</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="PARAM_CELLTYPE-constant" class="">PARAM_CELLTYPE =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for cell material/type</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cell Material/Type</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="PARAM_NUMBEROFCELLS-constant" class="">PARAM_NUMBEROFCELLS =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for total number of cells</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Total Number of Cells</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="PARAM_SOLARCELLAREA-constant" class="">PARAM_SOLARCELLAREA =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for solar cell area</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Solar Cell Area</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="PARAM_NOMOPERATINGCELLTEMP-constant" class="">PARAM_NOMOPERATINGCELLTEMP =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for nominal operating cell temp</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Nominal Operating Cell Temperature</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="PARAM_SHORTCKTCURRENTTEMPCOEF-constant" class="">PARAM_SHORTCKTCURRENTTEMPCOEF =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for short circuit current temp coefficient</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Short Circuit Current Temperature Coefficient</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="PARAM_OPENCKTVOLTAGETEMPCOEF-constant" class="">PARAM_OPENCKTVOLTAGETEMPCOEF =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for open circuit voltage temp coefficient</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Open Circuit Voltage Temperature Coefficient</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
        <dt id="PARAM_MAXPOWERTEMPCOEF-constant" class="">PARAM_MAXPOWERTEMPCOEF =
          <div class="docstring">
  <div class="discussion">
    
<p>Defines the PV Module parameter for maximum power temp coefficient</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Maximum Power Temperature Coefficient</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#csv_parameters-class_method" title="csv_parameters (class method)">+ (Array&lt;String&gt;) <strong>csv_parameters</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the list of csv parameters established for this product category
Overrides ProducBase.csv_parameters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expect_map%3F-class_method" title="expect_map? (class method)">+ (Boolean) <strong>expect_map?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns whether or not this product category is set up for including a
performance map Overrides ProductBase.expect_map?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_bcl_parameters-class_method" title="get_bcl_parameters (class method)">+ ({String=&gt;FixNum}) <strong>get_bcl_parameters</strong>(product_data) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the parameters that could be included in the BCL Overrides
ProductBase.get_bcl_parameters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-class_method" title="name (class method)">+ (String) <strong>name</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the name of this product category Overrides ProductBase.name.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#product_key-class_method" title="product_key (class method)">+ (String) <strong>product_key</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the TPE product key string for this product category Overrides
ProductBase.product_key.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#suitable_for_bcl%3F-class_method" title="suitable_for_bcl? (class method)">+ (Boolean) <strong>suitable_for_bcl?</strong>(product_data) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Used to determine if the data entered for this product is suitable for
mapping to the BCL Any number of rules could be enforced in this routine,
as it is called once all product data has been interpreted Overrides
ProductBase.suitable_for_bcl?.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_component-class_method" title="write_component (class method)">+ (Object) <strong>write_component</strong>(product_data) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Overrides ProductBase.write_component.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_map_component_parameters-class_method" title="write_map_component_parameters (class method)">+ (Object) <strong>write_map_component_parameters</strong>(product_data, merged_data_set, _type) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This routine writes the map-based components for this component.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="csv_parameters-class_method">
  
    + (<tt>Array&lt;String&gt;</tt>) <strong>csv_parameters</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the list of csv parameters established for this product category
Overrides ProducBase.csv_parameters</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A list of csv parameter names</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56
57
58
59
60</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/products/PVModules.rb', line 50</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_csv_parameters'>csv_parameters</span>
  <span class='lbracket'>[</span><span class='const'>PARAM_MODULEEFFICIENCY</span><span class='comma'>,</span>
   <span class='const'>PARAM_RATEDPOWER</span><span class='comma'>,</span>
   <span class='const'>PARAM_CELLTYPE</span><span class='comma'>,</span>
   <span class='const'>PARAM_NUMBEROFCELLS</span><span class='comma'>,</span>
   <span class='const'>PARAM_SOLARCELLAREA</span><span class='comma'>,</span>
   <span class='const'>PARAM_NOMOPERATINGCELLTEMP</span><span class='comma'>,</span>
   <span class='const'>PARAM_SHORTCKTCURRENTTEMPCOEF</span><span class='comma'>,</span>
   <span class='const'>PARAM_OPENCKTVOLTAGETEMPCOEF</span><span class='comma'>,</span>
   <span class='const'>PARAM_MAXPOWERTEMPCOEF</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expect_map?-class_method">
  
    + (<tt>Boolean</tt>) <strong>expect_map?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether or not this product category is set up for including a
performance map Overrides ProductBase.expect_map?</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if this product category expects a map, or false if not</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/products/PVModules.rb', line 65</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_expect_map?'>expect_map?</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_bcl_parameters-class_method">
  
    + (<tt>{String=&gt;FixNum}</tt>) <strong>get_bcl_parameters</strong>(product_data) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the parameters that could be included in the BCL Overrides
ProductBase.get_bcl_parameters</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>{String=&gt;FixNum}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns a hash mapping parameter names with averaged values</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/products/PVModules.rb', line 72</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_get_bcl_parameters'>get_bcl_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_product_data'>product_data</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parameters'>parameters</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_params_to_include'>params_to_include</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'>PARAM_CELLTYPE</span><span class='comma'>,</span>
                       <span class='const'>PARAM_NUMBEROFCELLS</span><span class='comma'>,</span>
                       <span class='const'>PARAM_SOLARCELLAREA</span><span class='comma'>,</span>
                       <span class='const'>PARAM_NOMOPERATINGCELLTEMP</span><span class='comma'>,</span>
                       <span class='const'>PARAM_SHORTCKTCURRENTTEMPCOEF</span><span class='comma'>,</span>
                       <span class='const'>PARAM_OPENCKTVOLTAGETEMPCOEF</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_params_to_include'>params_to_include</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
    <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='id identifier rubyid_x'>x</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='gvar'>$log</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Key BCL parameter, named &#39;</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_x'>x</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>&#39;, was not found in the input.  Skipping...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_parameters'>parameters</span><span class='lbracket'>[</span><span class='id identifier rubyid_x'>x</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_parameters'>parameters</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="name-class_method">
  
    + (<tt>String</tt>) <strong>name</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the name of this product category Overrides ProductBase.name</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The name of this product category</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/products/PVModules.rb', line 17</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Photovoltaic Modules</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="product_key-class_method">
  
    + (<tt>String</tt>) <strong>product_key</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the TPE product key string for this product category Overrides
ProductBase.product_key</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The product key for this product category</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/products/PVModules.rb', line 24</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_product_key'>product_key</span>
  <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>phtvlt</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="suitable_for_bcl?-class_method">
  
    + (<tt>Boolean</tt>) <strong>suitable_for_bcl?</strong>(product_data) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Used to determine if the data entered for this product is suitable for
mapping to the BCL Any number of rules could be enforced in this routine,
as it is called once all product data has been interpreted Overrides
ProductBase.suitable_for_bcl?</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Returns true if the product is suitable for pushing, false if not.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/products/PVModules.rb', line 95</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_suitable_for_bcl?'>suitable_for_bcl?</span><span class='lparen'>(</span><span class='id identifier rubyid_product_data'>product_data</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_required_parameters'>required_parameters</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'>PARAM_SOLARCELLAREA</span><span class='rbracket'>]</span>
  <span class='kw'>return</span> <span class='const'>ParameterList</span><span class='period'>.</span><span class='id identifier rubyid_validate_required_parameters'>validate_required_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_product_data'>product_data</span><span class='comma'>,</span> <span class='id identifier rubyid_required_parameters'>required_parameters</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write_component-class_method">
  
    + (<tt>Object</tt>) <strong>write_component</strong>(product_data) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Overrides ProductBase.write_component</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>product_data</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../SingleProductData.html" title="TpeBclCore::SingleProductData (class)">SingleProductData</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A product performance data structure used to write components</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


227
228
229
230
231
232
233</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/products/PVModules.rb', line 227</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_write_component'>write_component</span><span class='lparen'>(</span><span class='id identifier rubyid_product_data'>product_data</span><span class='rparen'>)</span>
  <span class='comment'># merge multiple maps
</span>  <span class='id identifier rubyid_merged_data_set'>merged_data_set</span> <span class='op'>=</span> <span class='const'>TpeBclCore</span><span class='op'>::</span><span class='const'>MapMethods</span><span class='period'>.</span><span class='id identifier rubyid_merge_multiple_maps'>merge_multiple_maps</span><span class='lparen'>(</span><span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_maps'>data_from_maps</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>TpeBclCore</span><span class='op'>::</span><span class='const'>Products</span><span class='op'>::</span><span class='const'>PVModule</span><span class='op'>::</span><span class='const'>Map</span><span class='op'>::</span><span class='const'>PVModuleMapDataPoint</span><span class='rparen'>)</span>

  <span class='comment'># write map components
</span>  <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_product_category'>product_category</span><span class='period'>.</span><span class='id identifier rubyid_write_map_component_parameters'>write_map_component_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_product_data'>product_data</span><span class='comma'>,</span> <span class='id identifier rubyid_merged_data_set'>merged_data_set</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write_map_component_parameters-class_method">
  
    + (<tt>Object</tt>) <strong>write_map_component_parameters</strong>(product_data, merged_data_set, _type) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This routine writes the map-based components for this component</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>product_data</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'><dl class="rdoc-list label-list"><dt>
<dd></dd></dl>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>merged_data_set</span>
      
      
        <span class='type'>(<tt>Array&lt;DataPoint&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A data set, after being post-processed with merging, to be written to the
osc</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/products/PVModules.rb', line 238</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_write_map_component_parameters'>write_map_component_parameters</span><span class='lparen'>(</span><span class='id identifier rubyid_product_data'>product_data</span><span class='comma'>,</span> <span class='id identifier rubyid_merged_data_set'>merged_data_set</span><span class='comma'>,</span> <span class='id identifier rubyid__type'>_type</span><span class='rparen'>)</span>
  <span class='comment'># get parameters first
</span>  <span class='id identifier rubyid_module_efficiency'>module_efficiency</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_MODULEEFFICIENCY</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_module_efficiency'>module_efficiency</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_module_efficiency'>module_efficiency</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_module_efficiency_string'>module_efficiency_string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_module_efficiency_string'>module_efficiency_string</span> <span class='op'>=</span> <span class='id identifier rubyid_module_efficiency'>module_efficiency</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_rated_power'>rated_power</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_RATEDPOWER</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_rated_power'>rated_power</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_rated_power'>rated_power</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_rated_power_string'>rated_power_string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_rated_power_string'>rated_power_string</span> <span class='op'>=</span> <span class='id identifier rubyid_rated_power'>rated_power</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_cell_type'>cell_type</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_CELLTYPE</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_number_of_cells'>number_of_cells</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_NUMBEROFCELLS</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_solar_cell_area_sqcm'>solar_cell_area_sqcm</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_SOLARCELLAREA</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_solar_cell_area'>solar_cell_area</span> <span class='op'>=</span> <span class='id identifier rubyid_solar_cell_area_sqcm'>solar_cell_area_sqcm</span> <span class='op'>*</span> <span class='float'>0.0001</span> <span class='op'>*</span> <span class='id identifier rubyid_number_of_cells'>number_of_cells</span>
  <span class='id identifier rubyid_nom_operating_cell_temp'>nom_operating_cell_temp</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_NOMOPERATINGCELLTEMP</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_max_power_temp_coef'>max_power_temp_coef</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_MAXPOWERTEMPCOEF</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_max_power_temp_coef'>max_power_temp_coef</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_max_power_temp_coef'>max_power_temp_coef</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_max_power_temp_coef_string'>max_power_temp_coef_string</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_max_power_temp_coef_string'>max_power_temp_coef_string</span> <span class='op'>=</span> <span class='id identifier rubyid_max_power_temp_coef'>max_power_temp_coef</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_skip_writing_merged_data'>skip_writing_merged_data</span> <span class='op'>=</span> <span class='id identifier rubyid_merged_data_set'>merged_data_set</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_skip_writing_merged_data'>skip_writing_merged_data</span>
    <span class='id identifier rubyid_short_ckt_current'>short_ckt_current</span> <span class='op'>=</span> <span class='id identifier rubyid_merged_data_set'>merged_data_set</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_short_ckt_current'>short_ckt_current</span>
    <span class='id identifier rubyid_open_ckt_voltage'>open_ckt_voltage</span>     <span class='op'>=</span> <span class='id identifier rubyid_merged_data_set'>merged_data_set</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_open_ckt_voltage'>open_ckt_voltage</span>
    <span class='id identifier rubyid_current_at_max_power'>current_at_max_power</span> <span class='op'>=</span> <span class='id identifier rubyid_merged_data_set'>merged_data_set</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_current_at_max_power'>current_at_max_power</span>
    <span class='id identifier rubyid_voltage_at_max_power'>voltage_at_max_power</span> <span class='op'>=</span> <span class='id identifier rubyid_merged_data_set'>merged_data_set</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_voltage_at_max_power'>voltage_at_max_power</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_short_ckt_current_temp_coef'>short_ckt_current_temp_coef</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_SHORTCKTCURRENTTEMPCOEF</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_open_ckt_voltage_temp_coef'>open_ckt_voltage_temp_coef</span> <span class='op'>=</span> <span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_data_from_csv'>data_from_csv</span><span class='period'>.</span><span class='id identifier rubyid_get_parameter_average_value_by_descriptor'>get_parameter_average_value_by_descriptor</span><span class='lparen'>(</span><span class='const'>PARAM_OPENCKTVOLTAGETEMPCOEF</span><span class='rparen'>)</span>

  <span class='gvar'>$pv</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>PhotovoltaicPerformanceEquivalentOneDiode</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='gvar'>$osm</span><span class='period'>.</span><span class='id identifier rubyid_osm_model'>osm_model</span><span class='rparen'>)</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setName'>setName</span><span class='lparen'>(</span><span class='id identifier rubyid_product_data'>product_data</span><span class='period'>.</span><span class='id identifier rubyid_product_name'>product_name</span><span class='rparen'>)</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setCelltype'>setCelltype</span><span class='lparen'>(</span><span class='id identifier rubyid_cell_type'>cell_type</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_cell_type'>cell_type</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setNumberofCellsinSeries'>setNumberofCellsinSeries</span><span class='lparen'>(</span><span class='id identifier rubyid_number_of_cells'>number_of_cells</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_number_of_cells'>number_of_cells</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setActiveArea'>setActiveArea</span><span class='lparen'>(</span><span class='id identifier rubyid_solar_cell_area'>solar_cell_area</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_solar_cell_area'>solar_cell_area</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>unless</span> <span class='id identifier rubyid_skip_writing_merged_data'>skip_writing_merged_data</span>
    <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setShortCircuitCurrent'>setShortCircuitCurrent</span><span class='lparen'>(</span><span class='id identifier rubyid_short_ckt_current'>short_ckt_current</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_short_ckt_current'>short_ckt_current</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setOpenCircuitVoltage'>setOpenCircuitVoltage</span><span class='lparen'>(</span><span class='id identifier rubyid_open_ckt_voltage'>open_ckt_voltage</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_open_ckt_voltage'>open_ckt_voltage</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setModuleCurrentatMaximumPower'>setModuleCurrentatMaximumPower</span><span class='lparen'>(</span><span class='id identifier rubyid_current_at_max_power'>current_at_max_power</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_current_at_max_power'>current_at_max_power</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setModuleVoltageatMaximumPower'>setModuleVoltageatMaximumPower</span><span class='lparen'>(</span><span class='id identifier rubyid_voltage_at_max_power'>voltage_at_max_power</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_voltage_at_max_power'>voltage_at_max_power</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>end</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setReferenceTemperature'>setReferenceTemperature</span><span class='lparen'>(</span><span class='int'>25</span><span class='rparen'>)</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setReferenceInsolation'>setReferenceInsolation</span><span class='lparen'>(</span><span class='int'>1000</span><span class='rparen'>)</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setTemperatureCoefficientofShortCircuitCurrent'>setTemperatureCoefficientofShortCircuitCurrent</span><span class='lparen'>(</span><span class='id identifier rubyid_short_ckt_current_temp_coef'>short_ckt_current_temp_coef</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_short_ckt_current_temp_coef'>short_ckt_current_temp_coef</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setTemperatureCoefficientofOpenCircuitVoltage'>setTemperatureCoefficientofOpenCircuitVoltage</span><span class='lparen'>(</span><span class='id identifier rubyid_open_ckt_voltage_temp_coef'>open_ckt_voltage_temp_coef</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_open_ckt_voltage_temp_coef'>open_ckt_voltage_temp_coef</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='gvar'>$pv</span><span class='period'>.</span><span class='id identifier rubyid_setNominalOperatingCellTemperatureTestCellTemperature'>setNominalOperatingCellTemperatureTestCellTemperature</span><span class='lparen'>(</span><span class='id identifier rubyid_nom_operating_cell_temp'>nom_operating_cell_temp</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_nom_operating_cell_temp'>nom_operating_cell_temp</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sat May 28 09:45:46 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.0.0).
</div>

  </body>
</html>